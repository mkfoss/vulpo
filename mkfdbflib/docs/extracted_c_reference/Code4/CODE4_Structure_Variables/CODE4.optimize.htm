<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>CODE4.optimize</title>

<!--(Meta)==========================================================-->

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content=ImportDoc>
<meta name=OriginalFile content="C:\Documentation\C Reference Guide Word Docs\code4.doc">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1064>
<meta name=layout-width content=741>


<!--(Links)=========================================================-->

<link rel="stylesheet" href="../code4.css">



<!--(Style Sheet)===================================================-->

<style>
<!--

A:visited {
	color: #800080;
}

A:link {
	color: #0000ff;
}

-->
</style>


</head>

<!--(Body)==========================================================-->


<body lang=EN-US>

<p class=StructMemberHeading>CODE4.optimize</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Usage:&nbsp;&nbsp;&nbsp; 
 </span></span>int CODE4.optimize = OPT4EXCLUSIVE</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span 
 class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Description:&nbsp;&nbsp;&nbsp; 
 </span></span>This member specifies the initial memory read optimization 
 status to be used when files are opened and created. The default can be 
 overridden afterwards by calling <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">file4optimize </span></span>or 
 <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">d4optimize</span></span>.</p>

<p class=Body
	style="text-indent: 0px;">Possible choices for <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">CODE4.optimize </span></span>are 
 as follows:</p>

<p class=BodyIndent>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=InlineCommentText><span 
 style="font-size: 9.0pt; font-family: Arial;">OPT4EXCLUSIVE</span></span>&nbsp;&nbsp; 
 Read-optimize when files are opened exclusively, when the <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">S4STAND_ALONE</span></span><span 
 class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">&nbsp;</span></span>compilation 
 switch is defined, or when the DOS read-only attribute is set for the 
 file. Otherwise, do not read optimize. This is the default value.</p>

<p class=BodyIndent
	style="text-indent: 0px;">Note that there is a distinction between 
 a DOS read-only attribute and a network read file permission. A DOS read-only 
 attribute means that no one may write to the file, while a network permission 
 setting for any given file may be different from user to user.</p>

<p class=BodyIndent>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPT4OFF</span></span>&nbsp;&nbsp; 
 Do not read optimize.</p>

<p class=BodyIndent
	style="margin-left: 162.7pt; text-indent: -99.35pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPT4ALL</span></span>&nbsp;&nbsp; 
 Read optimize all files, including those opened/created in shared mode. 
 </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="margin-left: 5.4pt;
				border-collapse: collapse;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0>

<tr>
<td style="x-cell-content-align: top;
			width: 89.7pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;"
	valign=top
	width=89.7pt>
<p class=Body
	style="margin-left: 0in; text-indent: 0in;"><img src="../../Images/Note.gif" v:shapes="_x0000_i1042" x-maintain-ratio="TRUE" style="border-style: none;
															width: 47px;
															height: 40px;
															float: none;
															border-style: none;" width="47" height="40" border="0">&nbsp;<b><sup><span 
 style="font-size: 16.0pt; font-family: Arial;">Note</span></sup></b></td>
<td style="x-cell-content-align: top;
			width: 306.3pt;
			border: solid #000000 .75pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;
			background-color: #e5e5e5;"
	bgcolor=#E5E5E5
	valign=top
	width=306.3pt>
<p class=NoteText>Use memory optimization on shared files with caution. 
 When using memory read optimization on shared files, it is possible for 
 inconsistent data to be returned if another application is updating the 
 data file. This means that any data returned, from the memory optimized 
 file, could potentially be out of date. </td></tr>
</table>

<p class=Body
	style="margin-top: 6.0pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle
		style="font-size: 9.0pt; font-family: Arial;">See Also:</span><span 
 class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;">&nbsp;&nbsp; <a href="CODE4.accessMode.htm">CODE4.accessMode</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="CODE4.optimizeWrite.htm">CODE4.optimizeWrite</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="../../Data_File_Functions/d4optimize.htm">d4optimize</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="../../File_Functions/file4optimize.htm">file4optimize</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="../CodeBase_Function_Reference/code4optStart.htm">code4optStart</a></span></p>

<p class=SourceCode>/*ex11.c*/</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>#include &quot;d4all.h&quot;</p>

<p class=SourceCode>extern unsigned _stklen = 10000 ; /* for all Borland 
 compilers */</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void main ()</p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; CODE4 cb ;</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *inventory ;</p>

<p class=SourceCode>&nbsp;&nbsp; FIELD4 *minOnHand, *onHand, *stockName;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; int oldOpt, oldExcl ;</p>

<p class=SourceCode>&nbsp;&nbsp; int count ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4init( &amp;cb );</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; oldOpt = cb.optimize ; /* save old optimization 
 setting.*/</p>

<p class=SourceCode>&nbsp;&nbsp; oldExcl = cb.accessMode ;</p>

<p class=SourceCode>&nbsp;&nbsp; cb.optimize = OPT4EXCLUSIVE ; /* optimize 
 all new files */</p>

<p class=SourceCode>&nbsp;&nbsp; cb.accessMode = OPEN4DENY_RW ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; inventory = d4open( cb, &quot;INVENT.DBF&quot;) 
 ; /* Read optimized */</p>

<p class=SourceCode>&nbsp;&nbsp; minOnHand = d4field( inventory, &quot;MIN_ON_HND&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; onHand = d4field( inventory, &quot;ON_HAND&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; stockName = d4field( inventory, &quot;ITEM&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; count = 0 ;</p>

<p class=SourceCode>&nbsp;&nbsp; if( cb.errorCode &gt;= 0 )</p>

<p class=SourceCode>&nbsp;&nbsp; {</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; code4optStart( 
 &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for( d4top( inventory 
 ) ; ! d4eof( inventory) ; d4skip( inventory, 1L) )</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if( f4long(onHand) 
 &lt; f4long( minOnHand ) )</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 count++ ;</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; code4optSuspend( 
 &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; }</p>

<p class=SourceCode>&nbsp;&nbsp; cb.optimize = oldOpt ;</p>

<p class=SourceCode>&nbsp;&nbsp; cb.accessMode = oldExcl ;</p>

<p class=SourceCode>&nbsp;&nbsp; d4close( inventory) ;</p>

<p class=SourceCode>&nbsp;&nbsp; printf( &quot;%d items need to be restocked&quot;, 
 count) ;</p>

<p class=SourceCode>&nbsp;&nbsp; code4initUndo( &amp;cb ) ;</p>

<p class=SourceCode>}</p>

</body>

</html>
