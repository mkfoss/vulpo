<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>CODE4.accessMode</title>

<!--(Meta)==========================================================-->

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content=ImportDoc>
<meta name=OriginalFile content="C:\Documentation\C Reference Guide Word Docs\code4.doc">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1149>
<meta name=layout-width content=742>


<!--(Links)=========================================================-->

<link rel="stylesheet" href="../code4.css">



<!--(Style Sheet)===================================================-->

<style>
<!--

A:visited {
	color: #800080;
}

A:link {
	color: #0000ff;
}

-->
</style>


</head>

<!--(Body)==========================================================-->


<body lang=EN-US>

<p class=StructMemberHeading>CODE4.accessMode</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Usage:</span></span>&nbsp;&nbsp; 
 int CODE4.accessMode = OPEN4DENY_NONE</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span 
 class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Description:</span></span>&nbsp;&nbsp; 
 This member variable determines the file access mode for all files that 
 are either opened or created. Access to these files in <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">OPEN4DENY_RW </span></span>mode 
 (see below) is quicker, since the file is used exclusively, thus making 
 record and file locks unnecessary. The performance increase is even greater 
 when optimizations are enabled.</p>

<p class=Body
	style="text-indent: 0px;">It is recommended that <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">CODE4.accessMode</span></span> 
 be set to <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">OPEN4DENY_RW 
 </span></span>whenever creating, packing, zapping, compressing, or reindexing 
 files. Failure to do so can result in errors being generated by other 
 applications accessing the files while the given process is executing.</p>

<p class=Body
	style="text-indent: 0px;"><span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4.accessMode</span></span> 
 is set to <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">OPEN4DENY_NONE</span></span> 
 by default.</p>

<p class=Body
	style="text-indent: 0px;">The possible values for this member variable 
 are:</p>

<p class=BodyIndent><span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPEN4DENY_NONE</span></span>&nbsp;&nbsp; 
 Open the data files in shared mode. Other users have read and write access.</p>

<p class=BodyIndent><span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPEN4DENY_WRITE</span></span>&nbsp;&nbsp; 
 Open the data files in shared mode. The application may read and write 
 to the files, but other users may only open the file in read only mode 
 and may not change the files.</p>

<p class=BodyIndent>&nbsp;&nbsp;&nbsp;&nbsp; <span class=InlineCommentText><span 
 style="font-size: 9.0pt; font-family: Arial;">OPEN4DENY_RW</span></span>&nbsp;&nbsp; 
 Open the data files exclusively. Other users may not open the files.</p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="margin-left: 5.4pt;
				border-collapse: collapse;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0>

<tr>
<td style="x-cell-content-align: top;
			width: 89.7pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;"
	valign=top
	width=89.7pt>
<p class=Body
	style="margin-left: 0in; text-indent: 0in;"><img src="../../Images/Note.gif" v:shapes="_x0000_i1026" x-maintain-ratio="TRUE" style="border-style: none;
															width: 47px;
															height: 40px;
															float: none;
															border-style: none;" width="47" height="40" border="0">&nbsp;<b><sup><span 
 style="font-size: 16.0pt; font-family: Arial;">Note</span></sup></b></td>
<td style="x-cell-content-align: top;
			width: 306.3pt;
			border: solid #000000 .75pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;
			background-color: #e5e5e5;"
	bgcolor=#E5E5E5
	valign=top
	width=306.3pt>
<p class=NoteText><span class=InlineFunctionNames><span style="font-size: 10.0pt;">CODE4.accessMode</span></span> 
 specifies what OTHER users will be able to do with the file. <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt;">CODE4.readOnly</span></span> specifies what 
 the CURRENT user will be able to do with the file.</p>
<p class=NoteText>When a file is opened (which also occurs upon creation), 
 its read/write permission attributes are obtained from <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt;">CODE4.accessMode</span></span>. If this member 
 is altered, the change will only affect files that are opened afterwards. 
 Thus, to modify the read/write permission of an open file, it must first 
 be closed and then reopened.</td></tr>
</table>

<p class=Body
	style="margin-top: 6.0pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Client-Server:&nbsp;&nbsp;&nbsp; 
 </span></span>In the client-server configuration, the <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">CODE4.accessMode</span></span> 
 determines the client access to the file, but <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">CODE4.accessMode</span></span> 
 does not necessarily reflect how the file is physically opened. Refer 
 to the openMode setting of the server configuration file for more information. 
 The access to files can also be specified by the openMode setting server 
 configuration file.</p>

<p class=Body><span class=InlineFunctionDescTitle
					style="font-size: 9.0pt; font-family: Arial;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 See Also:</span>&nbsp;&nbsp; <span class=InlineFunctionNames
									style="font-size: 10.0pt; font-family: Arial;"><a href="CODE4.optimize.htm">CODE4.optimize</a></span><span class=InlineFunctionNames
															style="font-size: 12.0pt; font-weight: normal;">,</span><span 
 class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="../CodeBase_Function_Reference/code4optStart.htm">code4optStart</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="CODE4.readOnly.htm">CODE4.readOnly</a></span></p>

<p class=SourceCode>/*ex1.c*/</p>

<p class=SourceCode>#include &quot;d4all.h&quot;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>#ifdef __TURBOC__</p>

<p class=SourceCode>&nbsp;&nbsp; extern unsigned _stklen = 10000 ; // for 
 all Borland compilers</p>

<p class=SourceCode>#endif</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void main( )</p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; CODE4 codeBase ;</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *newDataFile ;</p>

<p class=SourceCode>&nbsp;&nbsp; FIELD4INFO fieldInfo [] =</p>

<p class=SourceCode>&nbsp;&nbsp; {</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&quot;NAME&quot;, 
 'C', 20, 0},</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&quot;AGE&quot;, 
 'N', 3, 0},</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&quot;BIRTHDATE&quot;, 
 'D', 8, 0},</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {0, 0, 0, 0},</p>

<p class=SourceCode>&nbsp;&nbsp; }</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4init( &amp;codeBase ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; codeBase.accessMode = OPEN4DENY_RW ;&nbsp;&nbsp; 
 /* prevents other</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 applications from having read and write</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 access to any files opened subsequently */</p>

<p class=SourceCode>&nbsp;&nbsp; codeBase.safety = 0 ; /* create overwrites 
 existing file(s) */</p>

<p class=SourceCode>&nbsp;&nbsp; newDataFile = d4create( &amp;codeBase, 
 &quot;NEWDBF&quot;, fieldInfo, 0 );</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; d4close( newDataFile ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; codeBase.accessMode = OPEN4DENY_NONE ; 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* open in shared mode */</p>

<p class=SourceCode>&nbsp;&nbsp; newDataFile = d4open( &amp;codeBase, &quot;NEWDBF&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; /* ... some other code ... */</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4close( &amp;codeBase ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; code4initUndo( &amp;codeBase ) ;</p>

<p class=SourceCode>}</p>

</body>

</html>
