<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>code4calcCreate</title>

<!--(Meta)==========================================================-->

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content=ImportDoc>
<meta name=OriginalFile content="C:\Documentation\C Reference Guide Word Docs\code4.doc">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=877>
<meta name=layout-width content=753>


<!--(Links)=========================================================-->

<link rel="stylesheet" href="../code4.css">



<!--(Style Sheet)===================================================-->

<style>
<!--

A:visited {
	color: #800080;
}

A:link {
	color: #0000ff;
}

-->
</style>


</head>

<!--(Body)==========================================================-->


<body lang=EN-US>

<h2>code4calcCreate</h2>

<p class=Body
	style="margin-left: 175.7pt; text-indent: -175.7pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Usage:&nbsp;&nbsp;&nbsp; 
 </span></span>EXPR4CALC *code4calcCreate( CODE4 *codebase, EXPR4&nbsp;*expr, 
 const&nbsp;char&nbsp;*name)</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span 
 class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Description:&nbsp;&nbsp;&nbsp; 
 </span></span>This function creates a user-defined function, which is 
 recognizable in any other dBASE expression and in the <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">EXPR4</span></span> structure 
 expressions. The function is not accessible outside of the expression 
 evaluation routines of CodeBase.</p>

<p class=Body
	style="text-indent: 0px;">Calculation names are defined without parentheses. 
 When used in a dBASE expression, however, a set of parentheses -- () -- 
 are appended to the calculation name. There may not be any characters 
 (including spaces) between the calculation's parentheses.</p>

<p class=Body
	style="text-indent: 0px;">If an expression is too long to be parsed 
 by <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">expr4parse</span></span><span 
 class=InlineFunctionNames><span style="font-size: 12.0pt; font-weight: normal;">,</span></span> 
 a CodeBase error is generated.<span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;"> 
 code4calcCreate</span></span> can be used to break up an expression into 
 manageable pieces, thus<span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;"> 
 </span></span>allowing longer expressions than would otherwise be possible.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=InlineFunctionDescTitle><span 
 style="font-size: 9.0pt; font-family: Arial;">Parameters:</span></span></p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">codebase&nbsp;&nbsp;&nbsp; 
 </span></span>A pointer to a<span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;"> 
 </span></span><span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4</span></span><span 
 class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;"> 
 </span></span>structure.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">expr&nbsp;&nbsp;&nbsp; 
 </span></span>This is the <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">EXPR4</span></span> 
 structure that specifies what the user-defined function returns.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">name&nbsp;&nbsp;&nbsp; 
 </span></span>This is the name of the user-defined function. <i>name</i> 
 can not exceed 19 characters in length.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Returns:</span></span></p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">Null&nbsp;&nbsp;&nbsp; 
 </span></span>Error. The user-defined function was not created.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">Not 
 Null&nbsp;&nbsp;&nbsp; </span></span>A non-zero return indicates success. 
 The <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">EXPR4CALC</span></span> 
 structure pointer is used inside CodeBase.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle
		style="font-size: 9.0pt; font-family: Arial;">See Also:</span>&nbsp;&nbsp; 
 <span class=InlineFunctionNames
		style="font-size: 10.0pt; font-family: Arial;"><a href="code4calcReset.htm">code4calcReset</a></span><span 
 class=InlineFunctionNames
	style="font-weight: normal;">, </span><span class=InlineFunctionNames
												style="font-size: 10.0pt; font-family: Arial;"><a href="../../Expression_Evaluation_Functions/expr4parse.htm">expr4parse</a></span></p>

<p class=SourceCode>/*ex16.c*/</p>

<p class=SourceCode>#include &quot;d4all.h&quot;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void main( void )</p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; CODE4 cb ;</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *db ;</p>

<p class=SourceCode>&nbsp;&nbsp; EXPR4 *ex, *ex2 ;</p>

<p class=SourceCode>&nbsp;&nbsp; EXPR4CALC *names ;</p>

<p class=SourceCode>&nbsp;&nbsp; char *result;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4init( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; db = d4open( &amp;cb, &quot;DATA&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; d4top( db ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; ex = expr4parse( db, &quot;TRIM(LNAME)+', 
 '+TRIM(FNAME)&quot; ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; names = code4calcCreate( &amp;cb, ex, 
 &quot;NAMES&quot; ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; expr4vary(ex, &amp;result) ;</p>

<p class=SourceCode>&nbsp;&nbsp; printf( &quot;%s is the result\n&quot;, 
 result ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; ex2 = expr4parse( db, &quot;'HELLO '+NAMES()&quot; 
 ) ; /*no space in dBASE function calls.*/</p>

<p class=SourceCode>&nbsp;&nbsp; expr4vary(ex2, &amp;result ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; printf( &quot;%s is the second result\n&quot;, 
 result ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; expr4free( ex2 ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; code4calcReset( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; code4initUndo(&amp;cb ) ;</p>

<p class=SourceCode>}</p>

</body>

</html>
