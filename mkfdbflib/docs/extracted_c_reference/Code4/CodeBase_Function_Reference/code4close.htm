<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>code4close</title>

<!--(Meta)==========================================================-->

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content=ImportDoc>
<meta name=OriginalFile content="C:\Documentation\C Reference Guide Word Docs\code4.doc">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=780>
<meta name=layout-width content=753>


<!--(Links)=========================================================-->

<link rel="stylesheet" href="../code4.css">



<!--(Style Sheet)===================================================-->

<style>
<!--

A:visited {
	color: #800080;
}

A:link {
	color: #0000ff;
}

-->
</style>


</head>

<!--(Body)==========================================================-->


<body lang=EN-US>

<h2>code4close</h2>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Usage:&nbsp;&nbsp;&nbsp; 
 </span></span>int code4close( CODE4 *codebase )</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span 
 class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Description:&nbsp;&nbsp;&nbsp; 
 </span></span><span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4close</span></span> 
 closes all open data, index and memo files. Before closing the files, 
 any necessary flushing to disk is done. In addition, the time stamps of 
 the files are updated if the files have been updated. <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">code4close</span></span> 
 is equivalent to calling <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">d4close</span></span> 
 for each and every data file opened. <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">code4close</span></span> 
 has no effect on files opened with <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">file4open</span></span>.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Locking:&nbsp;&nbsp;&nbsp; 
 </span></span><span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4close 
 </span></span>does any locking necessary to accomplish flushing to disk. 
 After any necessary updating is done, <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">code4close</span></span> 
 unlocks everything that has been locked.</p>

<p class=Body
	style="text-indent: 0px;">Before closing the file, <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">code4close </span></span>attempts 
 to flush the most recent changes to the record buffers. If a flush attempt 
 does not succeed, <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4close 
 </span></span>continues and closes the files anyway. Consequently, <span 
 class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4close</span></span> 
 never returns <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">r4locked 
 </span></span>or <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">r4unique</span></span>. 
 If it is important to trap these return codes, consider using <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">code4flush </span></span>before 
 calling <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4close</span></span>.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Returns:</span></span></p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">r4success&nbsp;&nbsp;&nbsp; 
 </span></span>Success.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">&lt; 
 0&nbsp;&nbsp;&nbsp; </span></span>Error.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle
		style="font-size: 9.0pt; font-family: Arial;">See Also:</span>&nbsp;&nbsp; 
 <span class=InlineFunctionNames
		style="font-size: 10.0pt; font-family: Arial;"><a href="../../Data_File_Functions/d4close.htm">d4close</a></span><span 
 class=InlineFunctionNames
	style="font-size: 12.0pt; font-weight: normal;">,</span><span class=InlineFunctionNames
	style="font-size: 10.0pt; font-family: Arial;"> <a href="code4flush.htm">code4flush</a></span></p>

<p class=SourceCode>/*ex17.c*/</p>

<p class=SourceCode>#include &quot;d4all.h&quot;</p>

<p class=SourceCode>extern unsigned _stklen = 10000 ; /* for all Borland 
 compilers */</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void openAFile( CODE4 *cb )</p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *d ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; /* 'd' falls out of scope. Data file is 
 still open*/</p>

<p class=SourceCode>&nbsp;&nbsp; d = d4open( cb, &quot;INFO&quot; ) ;</p>

<p class=SourceCode>}</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void main( void )</p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; CODE4 cb ;</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *d ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4init( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; cb.autoOpen = 0 ;</p>

<p class=SourceCode>&nbsp;&nbsp; openAFile( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; d = d4open( &amp;cb, &quot;DATA&quot; 
 ) ; /* open a second file */</p>

<p class=SourceCode>&nbsp;&nbsp; printf(&quot;Number of records in DATAFILE: 
 %d \n&quot;,d4recCount( d ) ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4close( &amp;cb ) ; /* INFO and DATAFILE 
 are both closed*/</p>

<p class=SourceCode>&nbsp;&nbsp; code4initUndo( &amp;cb ) ;</p>

<p class=SourceCode>}</p>

</body>

</html>
