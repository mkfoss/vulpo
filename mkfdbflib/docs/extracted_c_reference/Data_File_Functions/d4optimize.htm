<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>d4optimize</title>

<!--(Meta)==========================================================-->

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content=ImportDoc>
<meta name=OriginalFile content="C:\Documentation\C Reference Guide Word Docs\data4.doc">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1250>
<meta name=layout-width content=741>


<!--(Links)=========================================================-->

<link rel="stylesheet" href="data4.css">



</head>

<!--(Body)==========================================================-->


<body lang=EN-US>

<h2>d4optimize</h2>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Usage:&nbsp;&nbsp;&nbsp; 
 </span></span>int d4optimize( DATA4 *data, int optFlag )&nbsp;</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span 
 class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Description:&nbsp;&nbsp;&nbsp; 
 </span></span>This function sets the memory optimization strategy for 
 the data file and corresponding memo and index files.</p>

<p class=Body
	style="text-indent: 0px;">Memory optimization does not actually take 
 place until <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4optStart</span></span> 
 is called. If <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">code4optStart</span></span> 
 has been called, the file's memory optimizations are effective once the 
 file is flagged as memory optimized. This occurs when the file is opened 
 or after a call to <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">d4optimize</span></span>. 
 </p>

<p class=Body
	style="text-indent: 0px;">If read optimization is turned off, then 
 write optimization is also automatically turned off. If read optimization 
 is turned on, then the write optimization strategy becomes the default 
 as defined by <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4.optimizeWrite</span></span>. 
 </p>

<p class=Body
	style="text-indent: 0px;"><span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">d4optimize</span></span> 
 is not present, if the library was built with the <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">S4OFF_OPTIMIZE</span></span><span 
 class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">&nbsp;</span></span>switch 
 defined. </p>

<p class=Body
	style="text-indent: 0px;">Initially, files are optimized according 
 to the status of the <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4.optimize</span></span> 
 and <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4.optimizeWrite</span></span> 
 values at the time the file is opened. </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="margin-left: 5.4pt;
				border-collapse: collapse;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0>

<tr>
<td style="x-cell-content-align: top;
			width: 85.5pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;"
	valign=top
	width=85.5pt>
<p class=Body
	style="margin-left: 0in;
			text-indent: 0in;
			font-size: 16.0pt;
			font-family: Arial;"><b style="font-weight: bold;"><sup style="vertical-align: super;"><img src="../Images/Warning.gif" v:shapes="_x0000_i1055" x-maintain-ratio="TRUE" style="width: 91px;
			height: 57px;
			float: none;
			border-style: none;" width="91" height="57" border="0"></sup></b></td>
<td style="x-cell-content-align: top;
			width: 310.5pt;
			border: solid #000000 .75pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;
			background-color: #e5e5e5;"
	bgcolor=#E5E5E5
	valign=top
	width=310.5pt>
<p class=NoteText>Use memory optimization on shared files with caution. 
 When using memory read optimization on shared files, it is possible for 
 inconsistent data to be returned if another application is updating the 
 data file. This means that any data returned from the memory optimized 
 file could potentially be out of date.</td></tr>
</table>

<p class=Body
	style="margin-top: 6.0pt;
			margin-right: 0in;
			margin-bottom: 6.0pt;
			margin-left: 0in;
			text-indent: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Parameters:&nbsp;&nbsp;&nbsp; 
 </span></span>Possible choices for parameter <i>optFlag </i>are as follows: 
 </p>

<p class=BodyIndent>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=InlineCommentText><span 
 style="font-size: 9.0pt; font-family: Arial;">OPT4EXCLUSIVE&nbsp;&nbsp;&nbsp; 
 </span></span>Read-optimize when files are opened exclusively, when the 
 <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">S4OFF_MULTI</span></span><span 
 class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">&nbsp;</span></span>compilation 
 switch is defined, or when the DOS read-only attribute is set for the 
 file. Otherwise, do not read optimize. This is the default value. </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="margin-left: 5.4pt;
				border-collapse: collapse;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0>

<tr>
<td style="x-cell-content-align: top;
			width: 85.5pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;"
	valign=top
	width=85.5pt>
<p class=Body
	style="margin-left: 0in; text-indent: 0in;"><img src="../Images/Note.gif" v:shapes="_x0000_i1056" x-maintain-ratio="TRUE" style="width: 47px;
															height: 40px;
															float: none;
															border-style: none;" width="47" height="40" border="0">&nbsp;<b><sup><span 
 style="font-size: 16.0pt; font-family: Arial;">Note</span></sup></b></td>
<td style="x-cell-content-align: top;
			width: 310.5pt;
			border: solid #000000 .75pt;
			padding: 0in 5.4pt 0in 5.4pt;
			padding-left: 0px;
			padding-top: 0px;
			padding-right: 0px;
			padding-bottom: 0px;
			background-color: #e5e5e5;"
	bgcolor=#E5E5E5
	valign=top
	width=310.5pt>
<p class=NoteText>Note that there is a distinction between a DOS read-only 
 attribute and a network read file permission. A DOS read-only attribute 
 means that no one may write to the file, while a network permission setting 
 for any given file may be different from user to user. </td></tr>
</table>

<p class=BodyIndent
	style="margin-top: 6.0pt;
			margin-right: 0in;
			margin-bottom: 6.0pt;
			margin-left: 162.7pt;
			text-indent: -99.35pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPT4OFF&nbsp;&nbsp;&nbsp; 
 </span></span>Do not read optimize. </p>

<p class=BodyIndent>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">OPT4ALL&nbsp;&nbsp;&nbsp; 
 </span></span>This is the same as the <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">OPT4EXCLUSIVE</span></span> 
 option except shared files are also read optimized. </p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle><span style="font-size: 9.0pt; font-family: Arial;">Returns: 
 </span></span></p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">r4success&nbsp;&nbsp;&nbsp; 
 </span></span>Success. </p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineCommentText><span style="font-size: 9.0pt; font-family: Arial;">&lt; 
 0&nbsp;&nbsp;&nbsp; </span></span>Error. Flushing failed when optimization 
 was disabled, or <span class=InlineFunctionNames><span style="font-size: 10.0pt; font-family: Arial;">CODE4.errorCode</span></span> 
 contained a negative value. </p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=InlineFunctionDescTitle><span 
 style="font-size: 9.0pt; font-family: Arial;">Client-Server:</span></span>&nbsp;&nbsp; 
 In the client-server configuration, the optimization is controlled at 
 the server level, so the function <span class=InlineFunctionNames><span 
 style="font-size: 10.0pt; font-family: Arial;">d4optimize</span></span> 
 always returns success.</p>

<p class=Body>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=InlineFunctionDescTitle
		style="font-size: 9.0pt; font-family: Arial;">See Also:</span>&nbsp;&nbsp; 
 <span class=InlineFunctionNames
		style="font-size: 10.0pt; font-family: Arial;"><a href="../File_Functions/file4optimize.htm">file4optimize</a></span>, 
 <span class=InlineFunctionNames
		style="font-size: 10.0pt; font-family: Arial;"><a href="d4optimizeWrite.htm">d4optimizeWrite</a></span></p>

<p class=SourceCode>/*ex53.c*/</p>

<p class=SourceCode>#include &quot;d4all.h&quot; </p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>void main( void ) </p>

<p class=SourceCode>{</p>

<p class=SourceCode>&nbsp;&nbsp; CODE4 cb ;</p>

<p class=SourceCode>&nbsp;&nbsp; DATA4 *data, *extra ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4init( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; cb.accessMode = OPEN4DENY_RW ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; data = d4open( &amp;cb, &quot;INFO&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; /* Open the file exclusively, default 
 optimization is the same as if</p>

<p class=SourceCode>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 d4optimize( data, OPT4EXCLUSIVE ) were called.*/</p>

<p class=SourceCode>&nbsp;&nbsp; /* open a shared file. */</p>

<p class=SourceCode>&nbsp;&nbsp; cb.accessMode = OPEN4DENY_NONE ;</p>

<p class=SourceCode>&nbsp;&nbsp; extra = d4open( &amp;cb, &quot;DATA&quot; 
 ) ;</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; d4optimize( extra, OPT4ALL ) ; /* read 
 optimize the extra &quot;DATA&quot; file */</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4optStart( &amp;cb ) ; /* Begin the 
 memory optimizations.*/</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; /* .... Some other code .... */</p>

<p class=SourceCode>&nbsp;</p>

<p class=SourceCode>&nbsp;&nbsp; code4close( &amp;cb ) ;</p>

<p class=SourceCode>&nbsp;&nbsp; code4initUndo( &amp;cb ) ;</p>

<p class=SourceCode>}</p>

</body>

</html>
